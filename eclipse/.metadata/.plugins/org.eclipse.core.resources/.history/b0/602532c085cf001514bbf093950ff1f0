package me.diabolicatrix.events;

import me.diabolicatrix.gui.GuiSideSelection;
import me.diabolicatrix.mcliferpg.MinecraftLifeRPG;
import me.diabolicatrix.packets.PacketSync;
import me.diabolicatrix.proxy.ClientProxy;
import net.minecraft.client.Minecraft;
import net.minecraft.client.gui.GuiGameOver;
import net.minecraft.entity.DataWatcher;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraftforge.event.entity.EntityJoinWorldEvent;
import net.minecraftforge.client.event.GuiOpenEvent;
import net.minecraftforge.event.entity.EntityEvent.EntityConstructing;
import net.minecraftforge.event.entity.living.LivingDeathEvent;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraftforge.fml.common.gameevent.InputEvent;
import net.minecraftforge.fml.common.gameevent.PlayerEvent.PlayerLoggedInEvent;
import net.minecraftforge.fml.common.gameevent.TickEvent;

public class PlayerEventHandler
{

    @SubscribeEvent
    public void onPlayerLogin(PlayerLoggedInEvent event)
    {
        if(event.player != null)
        {
            ClientProxy.setLoaded(false);
        }
    }

    @SubscribeEvent
    public void onPlayerLoginTick(TickEvent.PlayerTickEvent event)
    {
        if(event.player != null && !ClientProxy.isLoaded())
        {
            if(!(Minecraft.getMinecraft().currentScreen instanceof GuiSideSelection))
            {
                Minecraft.getMinecraft().displayGuiScreen(new GuiSideSelection(event.player));
                System.out.println("Gui Opened!");
            }
        }
    }

    @SubscribeEvent
    public void onKeyInput(InputEvent.KeyInputEvent event)
    {
        if(ClientProxy.debug.isPressed())
        {
            DataWatcher dw = Minecraft.getMinecraft().thePlayer.getDataWatcher();
            System.out.println(dw.getWatchableObjectInt(25));
        }
    }
    
    @SubscribeEvent
    public void onGuiOpened(GuiOpenEvent event)
    {
        //System.out.println(event.gui);
        if(event.gui instanceof GuiGameOver)
        {
            event.setCanceled(true);
            Minecraft.getMinecraft().displayGuiScreen(new GuiRespawnMenu(Minecraft.getMinecraft().thePlayer));
        }
    }

}
